class SendModuleDataRemoveBackground{constructor(e){this.method=e,this.moduleParameters={nameFile:generateUUID(),backgroundColor:"transparent",reverseSelect:!1,SAM:[]},this.sourceFile={nameFile:null,urlFile:null,formatFile:null,fileSizeBytes:null,naturalWidth:null,naturalHeight:null,offsetWidth:null,offsetHeight:null,startTime:null,endTime:null}}}const callbacks={fetchSendModuleDataCallback:fetchSendModuleDataRemoveBackground,toggleModificationCallback:null,setMetaButtonCallback:setMetaButtonRemoveBackground,setMotionButtonCallback:null,setParametersButtonCallback:setParametersButtonRemoveBackground,setModuleImgButtonsCallback:setModuleImgButtons,setModuleVideoButtonsCallback:setModuleVideoButtons,setDefaultSendModuleData:SendModuleDataRemoveBackground};let sendModuleData=new SendModuleDataRemoveBackground(moduleName);async function fetchSendModuleDataRemoveBackground(){var e=Array.isArray(sendModuleData.moduleParameters.SAM)?0===sendModuleData.moduleParameters.SAM.length?(console.log("SAM is empty"),{tmpFileName:!1,validMessage:"Oopsie! Seems like you didn't pick an object in your content. Click on the «Select object» button and choose any object from the media, please!"}):(""===sendModuleData.moduleParameters.nameFile.trim()&&(sendModuleData.moduleParameters.nameFile=generateUUID()),"number"!=typeof sendModuleData.sourceFile.offsetWidth||isNaN(sendModuleData.sourceFile.offsetWidth)?(console.log("Offset width is not a number or is empty"),{tmpFileName:!1,validMessage:"Uh-oh! The width looks wonky. Double-check it's a number and not empty. Maybe click on «Select object» or load another file."}):"number"!=typeof sendModuleData.sourceFile.offsetHeight||isNaN(sendModuleData.sourceFile.offsetHeight)?(console.log("Offset height is not a number or is empty"),{tmpFileName:!1,validMessage:"Hmm... The height seems fishy. Verify it's a number and not empty. Check it's a number and not empty. Maybe click on «Select object» or load another file."}):["jpg","jpeg","png","gif","bmp"].includes(sendModuleData.sourceFile.formatFile.toLowerCase())?{tmpFileName:generateImageFilename(),validMessage:""}:["mp4","avi","mov","wmv","mkv"].includes(sendModuleData.sourceFile.formatFile.toLowerCase())?{tmpFileName:generateVideoFilename(),validMessage:""}:(console.log("The format file is neither an image nor a video format."),{tmpFileName:!1,validMessage:"Yikes! Looks like an alien format. Stick to images or videos for now."})):(console.log("SAM is not array"),{tmpFileName:!1,validMessage:"Oopsie! Seems like you didn't pick an object in your content. Click on the «Select object» button and choose any object from the media, please!"}),t=e.tmpFileName,e=e.validMessage;if(!1===t)return{statusBool:!1,validMessage:e};sendModuleData.sourceFile.nameFile=t;let a=sendModuleData.sourceFile.urlFile;return(a="string"==typeof a?await urlToBlob(a):a)?(console.log("download file"),await uploadChunkFile(a,t),sendModuleData.sourceFile.urlFile=null,console.log(JSON.stringify(sendModuleData,null,4)),await postModuleTaskEvent(sendModuleData),sendModuleData.sourceFile.urlFile=a,{statusBool:!0,validMessage:e}):{statusBool:!1,validMessage:e}}function setMetaButtonRemoveBackground(){var e=document.querySelector(".footer-parameters").querySelector("div"),t=(e.innerHTML="",document.createElement("div")),a=(t.classList.add("flex","gap-3","items-center","justify-between"),document.createElement("p"));a.classList.add("font-extra-thick"),a.textContent="Filename";const o=document.createElement("input");o.classList.add("px-2","py-1.5","rounded-md","bg-dark-elements","w-32","box-content","text-center","outline-none"),o.type="text",o.value=sendModuleData.moduleParameters.nameFile,o.disabled=!1;var l=document.createElement("div"),n=(l.classList.add("flex","gap-3","items-center","justify-between"),document.createElement("p"));n.classList.add("font-extra-thick"),n.textContent="Resized to";const s=document.createElement("input");s.classList.add("px-2","py-1.5","rounded-md","bg-dark-elements","w-32","box-content","text-center","outline-none"),s.type="text",s.value="1280x720",s.disabled=!0,getLimitResolution(moduleName).then(e=>{var t=sendModuleData.sourceFile.naturalWidth,a=sendModuleData.sourceFile.naturalHeight,e=setLimitResolution(e,t,a);s.value=e.newWidth+"x"+e.newHeight}).catch(e=>{}),o.addEventListener("input",function(e){var t=e.target.value;/^[a-zA-Z0-9-]*$/.test(t)||(e.target.value=t.slice(0,-1)),sendModuleData.moduleParameters.nameFile=o.value}),t.appendChild(a),t.appendChild(o),l.appendChild(n),l.appendChild(s),e.appendChild(t),e.appendChild(l)}function setParametersButtonRemoveBackground(){var e=document.querySelector(".footer-parameters").querySelector("div"),t=(e.classList.remove("mt-3"),e.innerHTML="",document.createElement("div")),a=(t.classList.add("flex","gap-3","items-center","justify-between"),document.createElement("p"));a.classList.add("font-extra-thick"),a.textContent="Background color";const o=document.createElement("div");o.classList.add("flex","gap-1.5","items-center","justify-between");["transparent","#008000","#00FF7F","#007FFF","#0000FF"].forEach(e=>{var t=document.createElement("div"),a=(t.classList.add("group"),document.createElement("button"));a.classList.add("w-9","h-9","rounded-md","color-picker","opacity-60","group-hover:opacity-100","transition-all"),a.type="button","transparent"===e?(a.style.background=`url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>')`,a.style.backgroundSize="15px"):a.style.backgroundColor=e,sendModuleData.moduleParameters.backgroundColor?sendModuleData.moduleParameters.backgroundColor===e&&(a.classList.remove("opacity-60"),a.style.border="2px solid white"):"transparent"===e&&(a.classList.remove("opacity-60"),a.style.border="2px solid white"),a.onclick=function(){o.querySelectorAll(".color-picker").forEach(e=>{e.classList.add("opacity-60"),e.style.border=""}),this.classList.remove("opacity-60"),this.style.border="2px solid white",sendModuleData.moduleParameters.backgroundColor=e},a.setAttribute("color",e),t.appendChild(a),o.appendChild(t)});var l=document.createElement("div"),n=(l.classList.add("flex","gap-1.5","items-center"),document.createElement("p"));n.classList.add("flex-1","basis-1/3"),n.textContent="Reverse select";const s=document.createElement("button");s.classList.add("rounded-md","flex","items-center","justify-center","transition-colors","font-normal","disabled:cursor-not-allowed","px-2.5","gap-2","py-2.5","basis-1/3","flex-1","!bg-dark-elements","hover:bg-dark-elements-hover","text-light-primary","bg-dark-elements"),sendModuleData.moduleParameters.reverseSelect&&(s.classList.add("!bg-accent-primary","!text-dark-background"),s.classList.remove("!bg-dark-elements")),s.innerHTML='<i class="fa-solid fa-thumbs-up"></i>',s.type="button",s.onclick=function(){s.classList.contains("!bg-dark-elements")?(s.classList.add("!bg-accent-primary","!text-dark-background"),s.classList.remove("!bg-dark-elements"),sendModuleData.moduleParameters.reverseSelect=!0):(s.classList.remove("!bg-accent-primary","!text-dark-background"),s.classList.add("!bg-dark-elements"),sendModuleData.moduleParameters.reverseSelect=!1)};var r=document.createElement("span"),d=(r.classList.add("w-full","h-px","bg-white","bg-opacity-20","shrink-0"),document.createElement("button"));d.classList.add("text-light-primary","opacity-60","hover:opacity-100","transition-opacity","-mt-2"),d.textContent="Reset",d.type="button",d.onclick=function(){o.querySelectorAll(".color-picker").forEach(e=>{"transparent"===e.getAttribute("color")?(e.classList.remove("opacity-60"),e.style.border="2px solid white"):(e.classList.add("opacity-60"),e.style.border="")}),s.classList.remove("!bg-accent-primary","!text-dark-background"),s.classList.add("!bg-dark-elements"),sendModuleData.moduleParameters.backgroundColor="transparent",sendModuleData.moduleParameters.reverseSelect=!1},t.appendChild(a),l.appendChild(n),l.appendChild(s),e.appendChild(t),e.appendChild(o),e.appendChild(l),e.appendChild(r),e.appendChild(d)}function setModuleImgButtons(){var e=[],t=setButtonSelectSourceSAM();return e.push(t),e}function setModuleVideoButtons(){var e=[],t=setButtonSelectSourceSAM();return e.push(t),e}function setButtonSelectSourceSAM(){var e=document.createElement("div"),t=(e.classList.add("relative","group"),document.createElement("div")),a=(t.classList.add("hidden","absolute","p-2","group-hover:flex","items-center","gap-3","bottom-full","left-1/2","-translate-x-1/2","-translate-y-3.5","bg-dark-elements-hover","rounded-md","w-[300px]"),document.createElement("img")),o=(a.classList.add("w-20","h-20","rounded-md"),a.src="/static/modules/thumbnail/select_object.png",a.alt="Segment object",a.width=256,a.height=256,document.createElement("span")),l=(o.classList.add("text-m-mobile","lg:text-m"),o.style="display: inline-block; vertical-align: top; text-decoration: inherit; text-wrap: balance;",o.textContent="Let the neural network handle it, then click to include with the right, exclude with the left. Don't forget to switch brushes.",document.createElement("div")),n=(l.classList.add("relative","flex","gap-2","items-center","rounded-md","bg-light-emphasis"),l.style.stroke="white",document.createElement("button")),s=(n.classList.add("text-danger-primary","stroke-danger-primary","relative","flex","gap-2","items-center","group","py-1.5","pl-2","whitespace-nowrap","font-extra-thick","pr-2"),n.type="button",n.innerHTML='<i class="fa-solid fa-object-group transition-[stroke,opacity] opacity-60 group-hover:opacity-100"></i>',document.createElement("span"));return s.textContent="Select object",n.onclick=function(){var e=document.querySelector(".footer-preview");e&&("img"===e.tagName.toLowerCase()&&e.src?createModalSAMImage(sendModuleData.sourceFile.urlFile,this,null):"video"===e.tagName.toLowerCase()&&e.src&&createModalSAMVideo(sendModuleData.sourceFile.urlFile,this,null))},n.appendChild(s),t.appendChild(a),t.appendChild(o),l.appendChild(n),e.appendChild(t),e.appendChild(l),e}createFooterVideoOrImage(callbacks);
